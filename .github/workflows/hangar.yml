name: Hangar Release Upload

on:
  workflow_dispatch:
    inputs:
     version:
       description: "The plugin version"
       required: true
       type: string
  #release:
  #  types:
  #    - published

jobs:
  buildJars:
    runs-on: ubuntu-latest
    name: 'Build Jar files'
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3
      - name: Setup JDK 16
        uses: actions/setup-java@v3
        with:
          distribution: temurin
          java-version: 16
          cache: 'maven'
      - name: Build Jars
        run: mvn --projects :core,:bukkit,:bungeecord,:velocity,:hangar-uploader clean install
      #- name: 'Get Version from Release'
      #  id: github-release
      #  run: |
      #    version=$(echo ${{ github.event.release.tag_name }} | cut -d'v' -f2)
      #    echo "PLUGIN_RELEASE=$version" >> $GITHUB_OUTPUT
      - name: 'Move Hangar-Uploader jar'
        working-directory: 'hangar-uploader/target/'
        run: 'mv HangarUploader.jar ../../'
      - name: 'Execute HangarUploader.jar'
        run: 'java -jar HangarUploader.jar ${{ secrets.HANGAR_TOKEN }} ${{ inputs.version }} Some test body!\nNew line?'
        #run: 'java -jar HangarUploader.jar ${{ secrets.HANGAR_TOKEN }} ${{ github.event.release.tag_name }} ${{ github.event.release.body }}'
